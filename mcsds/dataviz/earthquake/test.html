<!DOCTYPE html>
<svg width="960" height="600" fill="none" stroke="#000" stroke-linejoin="round" stroke-linecap="round"></svg>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://unpkg.com/topojson-client@3"></script>
<script>

    // Projection: equirectangular
    var width = 960,
        height = 960;

    var radius = height / 2 - 5,
        scale = radius,
        velocity = 0.2;

    var projection = d3.geoMercator()
        .translate([width/2, height/2]);

    var path = d3.geoPath()
        .projection(projection);

    var svg = d3.select("body").append("svg")
        .attr("width", width)
        .attr("height", height);


    var path = d3.geoPath();
    // Set the Map Up
    d3.json("https://unpkg.com/us-atlas@1/us/10m.json", function(error, us) {
        if (error) throw error;

        svg.append("path")
            .attr("stroke", "#aaa")
            .attr("stroke-width", 0.5)
            .attr("d", path(topojson.mesh(us, us.objects.counties, function(a, b) { return a !== b && (a.id / 1000 | 0) === (b.id / 1000 | 0); })));

        svg.append("path")
            .attr("stroke-width", 0.5)
            .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; })));

        svg.append("path")
            .attr("d", path(topojson.feature(us, us.objects.nation)));
    });
    // Start adding Circles
    d3.json('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson', function(error, quake) {
        if(error) throw error;
        // console.log(quake);

        svg.selectAll('circle')
            .data(quake.features)
            .enter().append('circle')
            .attr('cx', function(d) {
                return projection([d.geometry.coordinates[0], d.geometry.coordinates[1]])[0];
            })
            .attr('cy', function(d) {
                return projection([d.geometry.coordinates[0], d.geometry.coordinates[1]])[1];
            })
            .attr('r', function(d) {
                return d.properties.mag;
            })
            .style('fill', 'red')
            .style('opacity', 0.75)
            .call(d3.zoom()
                .scaleExtent([1 / 2, 4])
                .on('zoom', zoomed))
            .append('title')
            .text(function(d) {
                return 'Magnitue ' + d.properties.mag + ' ' + d.properties.place;
            });
    });



</script>
